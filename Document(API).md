# API说明文档
PS：域名（即API前缀）应以宏定义/常量的方式统一管理，便于修改，如：`#define API_WEBSITE http://example.com`

PS2：后续可能API会删除.php后缀，希望届时注意。

## 登录相关
### 登录
```
POST /login.php
```

输入参数：

```
username: 用户名
password: 用户名对应密码(明文即可)
```

输出(JSON格式):

```
{
	"status": 200, //返回状态码
	"msg": "OK", //状态码描述
	"data": {
		"token": "xxxxxxxxxxxxxxxxxxxxxxxxxx" //返回Token，仅在status为200时包含此字段
	}
}
```

输出状态码一览：

```
200: 正常，并返回Token
400: 请求方式或传参错误
403: 用户名或密码错误
```

其它说明：

```
返回的Token应当在后续请求中加入到HTTP请求头部的Authorization字段中。
```

### 注册
```
POST /register.php
```

输入参数：

```
username: 用户名(应为字母开头，不含大写字母，4-20字节)
password: 用户名对应密码(应为8-20字节，仅含大小写字母、数字、下划线(_)，明文即可)
```

输出(JSON格式):

```
{
	"status": 200, //返回状态码
	"msg": "OK", //状态码描述
	"data": {
		"token": "xxxxxxxxxxxxxxxxxxxxxxxxxx" //返回Token，仅在status为200时包含此字段
	}
}
```

输出状态码一览：

```
200: 注册成功，并返回Token
400: 请求方式或传参错误
403: 用户名已存在
404: 服务器链接错误，请稍后再试
1001: 用户名长度过短
1002: 密码长度过短
1003: 用户名长度过长
1004: 密码长度过长
1005: 用户名格式非法
1006: 密码格式非法
```

其它说明：

```
返回的Token应当在后续请求中加入到HTTP请求头部的Authorization字段中。
```

## 文章相关
### 获取文章列表

```
POST /article_feed.php
```

输入参数：

```
offset: 偏移量
count: 获取数
```

输出(JSON格式):

```
{
	"status": 200, //返回状态码
	"msg": "OK", //状态码描述
	"data": {
		//等同ByteDance所给接口Data中内容
	}
}
```

输出状态码：

```
200: 正常
400: 参数错误
401: 未登录或登录已过期(收到此状态码应跳转至登录界面)
```

### 获取文章内容

```
POST /article_content.php
```

输入参数:

```
groupId: 文章ID
```

输出(JSON格式):

```
{
	"status": 200, //返回状态码
	"msg": "OK", //状态码描述
	"data": {
		//等同ByteDance所给接口Data中内容
	}
}
```

输出状态码：

```
200: 正常
400: 参数错误
401: 未登录或登录已过期(收到此状态码应跳转至登录界面)
```

## 点赞相关
### 获取文章点赞数量
```
GET /like.php
```

输入参数:

```
id: 文章ID
```

输出(JSON参数):

```
{
	"status": 200, //返回状态码
	"msg": "OK", //状态码描述
	"data": {
		"liked": false, //登录用户是否已点赞过该文章
		"count": 0 //文章点赞总数
	}
}
```

输出状态码：

```
200: 正常
400: 参数错误
401: 未登录或登录已过期(收到此状态码应跳转至登录界面)
```

### 点赞文章
```
PUT /like.php
```

输入参数:

```
id: 文章ID
```

输出(JSON参数):

```
{
	"status": 200, //返回状态码
	"msg": "OK" //状态码描述
}
```

输出状态码：

```
200: 正常
400: 参数错误
401: 未登录或登录已过期(收到此状态码应跳转至登录界面)
```

### 取消点赞文章
```
DELETE /like.php
```

输入参数:

```
id: 文章ID
```

输出(JSON参数):

```
{
	"status": 200, //返回状态码
	"msg": "OK" //状态码描述
}
```

输出状态码：

```
200: 正常
400: 参数错误
401: 未登录或登录已过期(收到此状态码应跳转至登录界面)
```

## 评论相关
### 拉取评论列表
```
GET /comment.php
```

输入参数：
```
groupId: 文章ID
offset: UNIX时间戳作为偏移值，仅返回该文章大于该时间戳的评论
```

输出(JSON格式):

```
{
		"status": 200, //返回状态码
		"msg": "OK", //状态码描述
		"data": [
			{
				"id": 1212, //评论ID
				"time": "2019-5-1 00:00:00", //评论时间 
				"unix_time": 1558749000, //UNIX时间戳
				"author_id": 13, //用户ID
				"author": "Administrator", //用户昵称
				"avatar": "https://secure.gravatar.com/avatar/", //头像链接
				"description": "23333...", //评论对应用户的签名
				"content": "666" //评论内容
			},
			...
		]
}
```

输出状态码：

```
200: 正常
400: 参数错误
401: 未登录或登录已过期(收到此状态码应跳转至登录界面)
```

### 提交评论
```
PUT /comment.php
```

输入参数：
```
groupId: 文章ID
content: 评论内容
```

输出(JSON格式):

```
{
		"status": 200, //返回状态码
		"msg": "OK", //状态码描述
		"data": {
			"id": 1212, //提交成功的评论ID
			"time": "2019/5/1 00:00:00", //评论时间 
			"unix_time": 1558749000 //UNIX时间戳
		}
}
```

输出状态码：

```
200: 正常
400: 参数错误
401: 未登录或登录已过期(收到此状态码应跳转至登录界面)
```

## 个人信息页相关
### 上传头像
```
POST /avatar_upload.php
```

输入参数：

```
图片文件，仅支持JPG与PNG格式，设置Content-Type为image/png或image/jpeg。
```

输出(JSON格式):

```
{
		"status": 200, //返回状态码
		"msg": "OK", //状态码描述
		"data": {
				"url": "http://example.com/xxx/xxxx.jpg" //服务器保存的图片路径
		}
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 获取用户信息
```
GET /user.php
```

输入参数：

```
无
```

输出(JSON格式):

```
{
	"status": 200, //返回状态码
	"msg": "OK", //状态码描述
	"data": {
		"nickname": "Administrator", //用户昵称
		"signment": "23333", //签名
		"avatar": "https://secure.gravatar.com/avatar/", //头像图片链接
		"like_count": 0, //点赞数量
		"comment_count": 0 //评论数量
	}
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```

### 修改用户信息
```
POST /user.php
```

输入参数：

```
nickname: 修改的昵称
signment: 修改的签名
```

输出(JSON格式):

```
{
	"status": 200, //返回状态码
	"msg": "OK" //状态码描述
}
```

输出状态码:

```
200: OK
400: 输入参数错误
401: 授权验证失败，可能Token已经过期或无效(应跳转至登录界面)
```